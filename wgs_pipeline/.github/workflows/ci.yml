name: CI Pipeline Test

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Install Nextflow
      run: |
        wget -qO- https://get.nextflow.io | bash
        sudo mv nextflow /usr/local/bin/

    - name: Run nf-test
      uses: nf-core/nf-test@v3
      with:
        args: test .

    - name: Run pipeline dry-run
      run: |
        nextflow run main.nf -profile test --reads "test_data/*_R{1,2}.fastq.gz" --reference "test_data/ref.fa" -resume
